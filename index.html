<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wikipedia Navigation Game</title>
    <style>
        #content-container {
            border: 1px solid #ccc;
            padding: 15px;
            margin: 20px auto;
            max-width: 90%; /* Set a maximum width relative to the viewport */
            max-height: 80vh; /* Max height to 80% of the viewport height */
            overflow-y: auto; /* Enable scrolling if content exceeds the max height */
            resize: both; /* Allow the user to resize the container */
            box-sizing: border-box; /* Include padding and border in width/height calculations */
        }
    </style>

</head>
<body>
<div id="game-container">
    <h1>Wikipedia Navigation Game</h1>
    <p>Navigate from the Wikipedia homepage to a randomly chosen target page in the fewest clicks possible!</p>
    <button id="start-button">Start Game</button>
    <div id="status"></div>
    <div id="content-container"></div>
</div>

<script>
    let clickCount = 0;
    let targetPage = "";
    let currentPage = "Main Page"; // Starting page

    // Fetch a random Wikipedia page title
    async function getRandomWikipediaPage() {
        const response = await fetch("https://en.wikipedia.org/w/api.php?action=query&list=random&rnnamespace=0&rnlimit=1&format=json&origin=*");
        const data = await response.json();
        return data.query.random[0].title;
    }

    // Fetch HTML content of a Wikipedia page
    async function getWikipediaPageHTML(pageTitle) {
        const response = await fetch(`https://en.wikipedia.org/w/api.php?action=parse&page=${encodeURIComponent(pageTitle)}&format=json&origin=*`);
        const data = await response.json();
        return data.parse.text["*"]; // HTML content of the page
    }

    // Start the game
    async function startGame() {
        clickCount = 0;
        currentPage = "Main Page";
        targetPage = await getRandomWikipediaPage();
        document.getElementById("status").innerHTML = `Target Page: <strong>${targetPage}</strong><br>Current Page: <strong>${currentPage}</strong><br>Click Count: <strong>${clickCount}</strong>`;
        loadPageContent(currentPage);
    }

    // Load and display content of a Wikipedia page
    async function loadPageContent(pageTitle) {
        const contentContainer = document.getElementById("content-container");
        const htmlContent = await getWikipediaPageHTML(pageTitle);
        contentContainer.innerHTML = htmlContent;
        document.getElementById("status").innerHTML = `Target Page: <strong>${targetPage}</strong><br>Current Page: <strong>${currentPage}</strong><br>Click Count: <strong>${clickCount}</strong>`;
        enableLinkClicking(contentContainer);
    }

    // Handle link clicks within the page content
    function enableLinkClicking(container) {
        const links = container.querySelectorAll("a");
        links.forEach(link => {
            link.addEventListener("click", async (event) => {
                event.preventDefault(); // Prevent default link behavior
                const newPage = event.target.getAttribute("title");
                if (newPage) {
                    onLinkClick(newPage);
                }
            });
        });
    }

    // Handle navigation to a new page
    async function onLinkClick(selectedPage) {
        clickCount++;
        currentPage = selectedPage;
        if (currentPage === targetPage) {
            document.getElementById("status").innerHTML += `<br><strong>Congratulations! You've reached the target page in ${clickCount} clicks!</strong>`;
            document.getElementById("content-container").innerHTML = "";
        } else {
            loadPageContent(currentPage);
        }
    }

    // Event listener for the start button
    document.getElementById("start-button").addEventListener("click", startGame);
</script>
</body>
</html>
